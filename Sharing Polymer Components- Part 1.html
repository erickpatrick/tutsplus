<h1>Compartilhando Componentes do Polymer: Parte 1</h1>

<p>Em meu <a href="http://code.tutsplus.com/tutorials/using-polymer-to-create-web-components--cms-20475">último artigo sobre a biblioteca Polymer</a>, expliquei como aproveitar essa ótima ferramente para criar componentes web reutilizáveis. O ponto central do tutorial, bem como do uso de componentes, é ajudar nosso desenvolvimento através:</p>

<ul>
<li>Do encapsulamento da complexidade dos código e estrutura</li>
<li>Da possibilidade dos desenvolvedores usarem convenções de nomeação simples como as tags</li>
<li>Do fornecimento de elementos de Interface de Usuário (UI) para se usar e estender</li>
</ul>

<p>Estou bastante interessado por ela e quis explorar um pouco mais, verificando o novo modelo que a equipe do Polymer lançou para facilitar o desenvolvimento e reutilização de componentes, substancialmente, mais fácil.</p>

<h2>O Caminho Canônico</h2>

<p>Uma das peculiaridades do processo de desenvolvimento do Polymer que eu ainda não trabalhei foi o do rompimento entre o desenvolvimento do componente e a conseguir toná-lo disponível para reuso por outros. Vejamos um pequeno trecho do meu tutorial anterior:</p>

<pre class="brush: html">&lt;link rel="import" href="../bower_components/polymer/polymer.html"&gt;</pre>

<p>O propósito desse trecho de código é o de incluir o códibo base do Polymer, a API principal que permitirá você definir elementos customizáveis. Para desenvolvimento local e de testes, isso funciona perfeitamente, mas, infelizmente, o caminho especificado prevenirá você de compartilhar esse componente. A razão disso é que, se outra pessoa tentar instalar seu componente usando o <a href="http://bower.io/">Bower</a> (que é o meio preferido de instalação), ele acabará como irmão do Polymer, dentro do diretório <code>bower_components</code>.</p><p>O problema disso é que o componente procurará por <code>../bower_components/polymer/polymer.html</code>, que será um caminho inválido. Os componente sempre assumem que suas dependências são irmãs, então, ele deveria procurar, na verdade, por <code>../polymer/polymer.html</code>. Esse é o "caminho canônino".</p>

<p>Conversando com o super <a href="https://twitter.com/rob_dodson">Rob Dodson</a> da equipe do Polymer, ele disse que a única maneira de contornar isso era desenvolver da maneira que mostrei primeiro e, quando eu estivesse pronto para compartilhar meu componente, converter todos os meus caminhos de <code>bower_components</code> para <code>../</code>. </p>

<p>Isso, obviamente, não é ideal e eu, provavelmente, poderia ter criado alguma tarefa no Grunt para analisar meus componentes e fazer essas atualizações. Felizmente, a equipe do Polymer esteve ocupada nesse problema e apresentou uma solução criativa que eles chamam de <code>untitled-element</code>.</p>

<h2>O Modelo <code>untitled-element</code></h2>

<p>Quando falo do <code><a href="https://github.com/PolymerLabs/untitled-element">untitled-element</a></code>, refiro-me a um novo modelo base que está disponível para criarmos, de forma substancialmente mais fácil, componentes reusáveis e implementáveis, tendo uma base sólida que possamos trabalhar. Esse modelo ajuda a eliminar os problemas mencionados acima, ao:</p>

<ul>
<li>Prover um estrutura adequada de diretórios;</li>
<li>Incorporar um componente adicional que serve para documentar sua API;</li>
<li>Permitir que demonstre, facilmente, seu componente enquanto desenvolve <em>e</em> quando compartilha</li>
</ul>

<p>A grande vantagem disso é que sermos capazes de desenvolver um componente sem ter que passar pelo problema alterar os caminhos nos arquivo que, além de ser bem chato, podem fazer seu componente deixar de funcionar se esquecer algo.</p>

<p>Atualmente, o projeto faz parte do <a href="https://github.com/PolymerLabs/">PolymerLabs</a> enquanto ele é posto à prova em testes, mas, certamente, já é bem promissor:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/github.png"></figure>

<p>Agora, a primeira coisa que você fará é criar um diretório de desenvolvimento que guardará seu novo componente, bem como todos os componentes do Bower que você instalará. Nomeei o meu de <code>polymerdev</code>. Daqui, você precisará ir até o repositório no GitHub do <code><a href="https://github.com/PolymerLabs/untitled-element">untitled-element</a></code> e baixá-lo em seu próprio diretório de desenvolvimento. Essa passo é bastante importante porque você <em>precisa</em> extrair o conteúdo dentro daquele diretório para evitar os problemas de diretórios irmão, como mencionado mais cedo. </p>

<p>Extrair o arquivo <code>.zip</code> criará um novo diretório chamado <code>untitled-element-master</code> que contem os arquivos base para você criar seu novo componente. Você precisará renomear algumas coisas, com base no nome do seu componente. Isso inclui:</p>

<ul>
<li>O diretório <code>untitled-element-master</code></li>
<li><code>untitled-element.html</code></li>
<li><code>untitled-element.css</code></li>
</ul>

<p>I'm going to recreate the Reddit element that I created in my last tutorial, so this is what the changes would look like:</p>

<ul>
<li><code>untitled-element-master</code> -&gt; <code>reddit-element</code></li>
<li><code>untitled-element.html</code> -&gt; <code>reddit-element.html</code></li>
<li><code>untitled-element.css</code> -&gt; <code>reddit-element.css</code></li>
</ul>

<p>Here's what the directory looked like before:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/directory.png"></figure>

<p>And here's what it looks like after the updates:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/directory-new.png"></figure>

<p>The key thing to understand, is that you'll be working inside of the <code>reddit-element</code> folder when creating your component and in later steps, when we use Bower to install the Polymer components, that directory will be a direct sibling to the newly installed directories. I know I'm really harping on this point but it's an important thing to understand, since it affects your ability to share your component.</p>

<p>To finish this off, you're going to want to update the references to your component name, inside of the following files:</p>

<ul>
<li><code>bower.json</code></li>
<li><code>demo.html</code></li>
<li><code>reddit-element.html</code></li>
</ul>

<p>Each of these files contains references to <code>untitled-element</code> within the code and need to be updated. Remember that any references to <code>untitled-element</code> should be changed to <code>reddit-element</code>. If you want to be absolutely sure, do a global search-and-replace using your editor.</p>

<h2>Getting Setup for Bower</h2>

<p>Since Bower is the preferred method for installing Polymer and sharing components, let's go through a few steps to ensure that we setup the Reddit component's Bower configuration properly.</p>

<p>By default, the boilerplate includes a <code>bower.json</code> file. This file is used to list several things, including the name of the component and any dependencies that need to be installed to use it. Here's what it looks like:</p>

<pre class="brush: javascript">{
  "name": "reddit-element",
  "private": true,
  "dependencies": {
    "polymer": "Polymer/polymer#master"
  }
}
</pre>

<p>First, I'll remove the <code>private</code> property since it'll prevent the component from being listed in the Bower registry. Since it's supposed to be shareable, I want it to be listed. Also, the Reddit component needs to make an Ajax call, so I'm including a dependency on the Polymer <code><a href="https://github.com/Polymer/core-elements">core-elements</a></code> set of components which includes the Ajax functionality that I need. Lastly, I'll add a version number to track this going forward. Here's the end result:</p>

<pre class="brush: javascript">{
  "name": "reddit-element",
  "version": "0.0.1",
  "dependencies": {
    "polymer": "Polymer/polymer#~0.2.3",
    "core-elements": "Polymer/core-elements#~0.2.3",
  }
}</pre>

<p>The last bit of Bower configuration that needs to be done, is to create a file called <code><a href="http://bower.io/#custom-install-directory">.bowerrc</a></code> in the <code>reddit-element</code> folder which defines a custom install location for the dependencies of our component. This is defined as simple JSON data like this:</p>

<pre class="brush: javascript">{
   "directory": "../"
}</pre>

<p>What this essentially does is tells Bower to install any dependencies one level up, so that they're siblings of the <code>reddit-element</code> folder. The reason this is important is because when someone installs our component with Bower, it'll be placed into the <code>bower_components</code> folder as siblings to everything else in there (including Polymer). Structuring things this way, ensures that we're developing in the same way that we'll eventually be sharing. It also allows us to use the canonical path I mentioned above, ensuring a consistent way of referencing other components in our code. </p>

<p>Let's review the differences. If I didn't create the <code>.bowerrc</code> file and ran the <code>bower install</code> command, my directory structure would look like this:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/bower-norc.png"></figure>

<p>This installs the <code>bower_components</code> folder directly into the component's directory, which is not what I want. I want the <code>reddit-element</code> folder to be a sibling to all of the dependencies that it needs:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/bower-rc.png"></figure>

<p>This method ensures that when a user installs this component using Bower, the component and the dependencies will be installed properly into the <code>bower_components</code> folder.</p>

<p>With the <code>.bowerrc</code> file added to your component's folder and the <code>bower.json</code> setup with the proper dependencies, the next step is to run <code>bower install</code>, to have Bower pull down the appropriate components and add them to the project.</p>

<h2>Coming Up Next</h2>

<p>In this tutorial, I wanted to make sure I laid a solid foundation for how to use the new Polymer boilerplate and some of the rationale behind the design choices that the team has made. </p>

<p>In the next part of this series, I'm going to go over the new documentation component that's included in the boilerplate and how it will make sharing and demoing your component substantially easier. I'll also show you how to setup your component to be shared via the Bower registry.</p>
