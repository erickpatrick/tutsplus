<h1>Compartilhando Componentes do Polymer: Parte 2</h1>

<p>Na <a href="http://code.tutsplus.com/tutorials/sharing-polymer-components-part-1--cms-21264" target="_self">parte um</a> dessa série, mostrei como configurar o ótimo modelo <a href="https://github.com/PolymerLabs/untitled-element"><code class="inline">untitled-element</code></a>, que a equipe do Polymer criou para tornar a criação e compartilhamento de componentes, substancialmente, mais fácil. </p>

<p>No tutorial a seguir, aprofundarei nos itens que o <code class="inline">untitled-element</code> inclui, como a funcionalidade de auto-geração de documentação, e como preparar seu componente para distribuição via Bower. Continuarei usando o componente Reddit que criei no primeiro tutorial.</p>

<h2>Uma Melhor Olhada No <code class="inline">untitled-element</code></h2>

<p>Dentro do seu projeto modelo, há alguns arquivos chave que você usará:</p>

<ul>
<li><code class="inline">bower.json</code> - Permite especificar configurações e dependências do seu componente</li>
<li><code class="inline">untitled-element-master.html</code> - Layout do seu novo componente</li>
<li><code class="inline">untitled-element-master.css</code> - Folha de estilo que estilizará o modelo do seu novo componente</li>
<li><code class="inline">index.html</code> - Arquivo HTML que inclui a base do Polymer para a geração de documentação</li>
<li><code class="inline">demo.html</code> - Arquivo HTML que permitirá seus usuários testar seu componente</li>
</ul>

<p>Esses são os arquivos base que estão presentes quando você baixa o modelo a partir <a href="https://github.com/PolymerLabs/untitled-element">do repositório PolymerLabs no GitHub</a>, e servirão como a fundação do seu novo componente. Na parte um, nós renomeamos o arquivo <code class="inline">untitled-element-master.html</code> para <code class="inline">reddit-element.html</code>, e o arquivo <code class="inline">untitled-element-master.css</code> para <code class="inline">reddit-element.css</code>, uma vez que eles precisam ser nomeados tal qual nosso componente. Nós também atualizamos as referências a <code class="inline">untitled-element</code> nos arquivos, para garantir que referenciam o nome correto do componente.</p>

<p>Olhemos o código do arquivo <code class="inline">reddit-element.html</code>: </p>

<pre class="brush: html">&lt;link rel="import" href="../polymer/polymer.html"&gt;

&lt;!--
Element providing solution to no problem in particular.

##### Example

    &lt;reddit-element&gt;&lt;/reddit-element&gt;

@element reddit-element
@blurb Element providing solution to no problem in particular.
@status alpha
@url github.io
--&gt;
&lt;polymer-element name="reddit-element" attributes="notitle"&gt;

  &lt;template&gt;

    &lt;link href="reddit-element.css" rel="stylesheet" /&gt;

    &lt;content&gt;&lt;/content&gt;

  &lt;/template&gt;

  &lt;script&gt;

    Polymer({
      /**
       * The 'noevent' event is not actually fired from here,
       * we document it as an example of documenting events.
       *
       * @event noevent
       */

      /**
       * The 'notitle' attribute does not yet have a purpose.
       *
       * @attribute notitle
       * @type string
       */
      notitle: '',

      ready: function() {
      },

      /**
       * The 'task' method does no work at this time.
       *
       * @method task
       * @return {Object} Returns undefined.
       * @param {String} dummy Serves no purpose today.
       */
      task: function(dummy) {
      }

    });

  &lt;/script&gt;

&lt;/polymer-element&gt;
</pre>

<p>Fora o básico, da ligação com a base do Polymer, definição dos atributos e adição de um espaço reservad para a inclusção de JavaScript em seu componente, o <i>ponto chave</i> a notar é que as referências de recursos externos usam o caminho canônico mencionado antes. É por isso que a parte de preparação do Bower, na parte um desse tutorial, é tão importante. Ela garante que todas as dependências imitem o seu ambiente de desenvolvimento, tal qual seria se você já estivesse compartilhando seu componente.</p>

<p>Também note o monte de meta-documentação inclusa no componente. Há um motivo importante para isso. O modelo lança mão do elemento <em><a href="https://github.com/Polymer/core-component-page">core-component-page</a></em> para extrair a documentação do seu elemento para poder criar uma página de documentção no estilo do JSDoc! Se abrir o arquivo <code class="inline">index.html</code>, poderá ver a referência lá:</p>

<pre class="brush: html">&lt;core-component-page&gt;&lt;/core-component-page&gt;</pre>

<p>De cara, sem adicionar qualquer código, só executando o <code class="inline">index.html</code>, obtenho uma página de documentação da minha API, como essa:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/element-doc.png"></figure>

<p>Então, garantindo que você <a href="http://usejsdoc.org/about-getting-started.html">comenta adequadamente</a> seu componente, o modelo oferece as facilidades necessárias para criar essa documentação de API incrivelmente útil.</p>

<p>E, também, se olhar para o canto esquerdo da página de documentação, logo ao lado do nome do elemento, há um botão com o nome <b>demo</b>:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/element-doc-demo.png"></figure>

<p>Clicá-lo fará uma chamada ao arquivo <code class="inline">demo.html</code>. Essa é uma outra característica importante porque, quando você publicar seu componente, outros poderão ter, além de uma ótima documentação para seguir, mas, também, a possibilidade de testar seu componente imediatamente, para ver se satisfaz as necessidades deles. Falaremos sobre isso já-já.</p>

<p>É assim que o componente Reddit parece, depois que passei o código do componente para o modelo:</p>

<pre class="brush: html">&lt;link rel="import" href="../polymer/polymer.html"&gt;
&lt;link rel="import" href="../core-ajax/core-ajax.html"&gt;

&lt;!--
Element that returns the public descript of a subreddit

##### Example

    &lt;reddit-element subreddit="cute"&gt;&lt;/reddit-element&gt;

@element reddit-element
@blurb Element that returns the public descript of a subreddit
@status alpha
@url github.io
--&gt;
&lt;polymer-element name="reddit-element" attributes="subreddit"&gt;

  &lt;template&gt;

    &lt;link href="reddit-element.css" rel="stylesheet" /&gt;

    &lt;core-ajax url="http://www.reddit.com//r/{{subreddit}}/about.json" auto response="{{resp}}"&gt;&lt;/core-ajax&gt;

    &lt;div class="myreddit"&gt;{{resp.data.public_description}}&lt;/div&gt;

  &lt;/template&gt;

  &lt;script&gt;

    Polymer({
      /**
       * The 'subreddit' attribute takes in the name of a subreddit.
       * It defaults to the 'aww' subreddit if no value is passed
       *
       * @attribute subreddit
       * @type string
       */
      subreddit: "aww"

    });

  &lt;/script&gt;

&lt;/polymer-element&gt;
</pre>

<p>As principais diferenças são que, agora, lança mão dos comentários a la JSDoc e o uso dos caminhos canônicos para acessar os componentes irmãos necessários. Também adicionei algumas poucas regras de estilo no arquivo <code class="inline">reddit-element.css</code> para melhorar um pouco as coisas:</p>

<pre class="brush: css">.myreddit {
    width: 300px;
    height: 300px;
    font-size: 16px;
    font-family: Tahoma;
}
</pre>

<p>E, claro, agora, tenho uma bela página de documentação para o meu componente:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/element-doc-final.png"></figure>

<h2>Enviando Para o GitHub</h2>

<p>Para distribuir seu componente através do Bower, é necessário haja acesso online via Git e que haja um rótulo Git com um número de versão correspondente, para que os usuários saibam que versão eles estão instalando. Para esse tutorial, usaremos o GitHub.</p>

<p>Os passos iniciais são relativamente fáceis e comuns para qualquer pessoa familiarizada com o Git, uma vez que basta criar um repositório local, adicionar e entregar (<em>commit</em>) seus arquivos do projeto atual e, então, enviá-los para o GitHub. Assumirei que usará o Terminal, que tem o Git instalado e que já possui uma conta no GitHub:</p>

<ol>
<li>Certifique-se que está no diretório do seu componente (ex: <code class="inline">reddit-element</code>)</li>
<li>Digite <code class="inline">git init</code> para inicializar um repositório local no diretório em questão</li>
<li>Digite <code class="inline">git add .</code> para adicionar todos os seus arquivos</li>
<li>Digite <code class="inline">git commit -am ‘Meu primeiro commit'</code> para entregar seus arquivos ao repositório</li>
<li>Crie um novo repositório no GitHub, com o nome do seu componente (ex: <code class="inline">reddit-element</code>)</li>
<li>Digite <code class="inline">git remote add origin </code><a href="https://github.com//reddit-element.git"><code class="inline">https://github.com//reddit-element.git</code></a> para indicar que o local remoto do seu repositório é o repositório recém criado no GitHub.</li>
<li>Digite <code class="inline">git push -u origin master</code> para enviar os arquivos para o GitHub.</li>
</ol>

<p>Se você recarregar a página do seu repositório no GitHub, você deverá ver todos os arquivos do seu componente.</p>

<p>Quando você tiver feito todas as mudanças necessárias e achar que já pode liberar seu componente, será preciso que você crie um rótulo de lançamento para ele. Isso é feito, criando um rótulo via Git que marca um ponto específico na história do seu repositório. Você pode fazer isso pela linha de comando, porém, a forma mais fácil de fazer isso é através do GitHub, clicando no link "<b>releases</b>" link:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/release.png"></figure>

<p>Isso mostrará o processo de como criar um lançamento para seu componente:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/release-2.png"></figure>

<p>Clicando no botão "<b>Create a new release</b>" levará você a um formulário que permitirá definir informações sobre esse lançamento em específico, incluindo o número da versão, o ramo (<em>branch</em>) alvo e informações gerais sobre o lançamento. O Bower segue o modelo de versionamento semântico e você deveria seguir o mesmo caminho. Por exemplo, no arquivo <code class="inline">bower.json</code>, listei o número de versão do componente como "<code class="inline">0.0.1</code>", então, seguirei a mesma técnica para o meu lançamento.</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/release-3.png"></figure>

<p>Daqui, basta, simplesmente, apertar o botão <b>publishing</b> e, pronto! Um novo lançamento:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/release-final.png"></figure>

<p>Novamente, esse é um passo importante que ajudará seus usuários a encontrar uma versão específica no histórico do seu componente.</p>

<p>A última coisa que precisamos fazer no GitHub é publicar uma página para o componente. A página será a página da documentação que é gerada automaticamente pelo modelo, tornando a documentação e a versão de demonstração disponíveis para você compartilhar facilmente. Para fazer isso, a equipe do Polymer criou um código simples que lida com a criação do ramo para páginas no GitHub, para seu repositório. Você precisará baixar o arquivo do respositório do Polymer no GitHub e executálo <em>dentro do diretório pai</em> do componente. Dei enfaze a isso para que você possa executá-lo no lugar exato. Eis os passos:</p>

<ol>
<li>Volte para o diretório pai do componente</li>
<li>Digite <code class="inline">git clone git://github.com/Polymer/tools.git</code> para baixar/clonar o código</li>
<li>Digite <code class="inline">mkdir temp &amp;&amp; cd temp</code> para criar um novo diretório e ir para ele</li>
<li>Digite <code class="inline">../tools/bin/gp.sh  test-element</code> substituindo com o seu nome de usuário do GitHub</li>
<li>Volte para o diretório pai e remova o diretório <em>temp</em> (ex: <code class="inline">rm -rf temp</code>)</li>
</ol>

<p>O ramo da página foi criado:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/gh-pages.png"></figure>

<p>Isso, agora, permite compartilhar o componente através do seguinte link:</p>

<p><a href="http://reybango.github.io/reddit-element/components/reddit-element/">http://reybango.github.io/reddit-element/components/reddit-element/</a></p>

<p>Bem simples!</p>

<h2>Tornando-o Instalável Através do Bower</h2>

<p>O passo final para tornar seu componente disponível para o mundo é registrá-lo na Listagem do Bower. Vários do passos até aqui foram realizado, explicitamente, para ajudar a chegar nesse ponto.</p>

<p>O Bower usa um arquivo manifesto para descobrir as informações correspondentes ao pacote que está instalado. É aqui que o arquivo <code class="inline">bower.json</code> entra em ação. Ele é o arquivo manifesto que o Bower usará. Eis o conteúdo atual:</p>

<pre class="brush: javascript">{
  "name": "reddit-element",
  "version": "0.0.1",
  "dependencies": {
    "polymer": "Polymer/polymer#~0.2.3",
    "core-elements": "Polymer/core-elements#~0.2.3"
  }
}
</pre>

<p>Precisamos atualizá-lo com informações adicionais que a Listagem do Bower usará para mostrar quando algum usuário estiver avaliando seu componente. Entre as informações estão:</p>

<ul>
<li>Ñome do auto</li>
<li>Descrição do componente</li>
<li>Palavras-chave que descrevem o componente</li>
<li>Tipo de licença que o componente foi lançado</li>
<li>A página do componente (ex: a página no GitHub que acabamos de criar)</li>
</ul>

<p>Com essas mudanças no lugar, o arquivo <code class="inline">bower.json</code> parece com isso, agora:</p>

<pre class="brush: javascript">{
  "name": "reddit-element",
  "version": "0.0.1",
  "authors": [
        "Rey Bango"
  ],
  "description": "Um componente demo que busca a descrição pública de subreddits",
  "keywords": [
    "'Polymer",
    "web-components",
    "Reddit"
  ],
  "license": "MIT",
  "homepage": "https://github.com/reybango/reddit-element",
  "dependencies": {
    "polymer": "Polymer/polymer#~0.2.3",
    "core-elements": "Polymer/core-elements#~0.2.3"
  }
}
</pre>

<p>As palavras-chave são importantes para a descoberta, então, esforce-se um pouco nelas.</p>

<p>Finalmente, estamos no último passo para poder ser listado. Usaremos o comando <em>bower register</em>, através do Terminal, para registrar nosso componente. Isso requererá o nome do componente o endereço Git (em nosso caso, no GitHub) do repositório online:</p>

<pre class="brush: bash">bower register polymer-demo git://github.com/johnsmith/polymer-demo.git
</pre>

<p>Isso tornará o componente disponível e procurável através da <a href="http://bower.io/search">Listagem do Bower</a>, bem como atravpes do comando <code class="inline">bower search</code>:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/bower-search.png"></figure>

<p>Agora posso instalar meu novo componente e todas suas dependências atravpes do comando a seguir:</p>

<pre class="brush: bash">bower install reddit-element --save
</pre>

<p>Isso o instalará no diretório <code class="inline">bower_components</code>, que é, exatamente, onde ele precisa ficar:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21497/image/bower-install.png"></figure>

<h2>O Novo Modelo É Ótimo</h2>

<p>Sou muito grato à equipe do Polymer pela criação desse modelo de onde podemos iniciar nossos próprios componentes. Transformaram a tediosa tarefa de lidar com caminhos em algo simples. E, ao incluir o elemento <em><a href="https://github.com/Polymer/core-component-page">core-component-page</a></em>, criar documentações e prover uma versão de demonstração é, incrivelmente, fácil de se fazer.</p>

<p>Espero que esse tutorial tenha demonstrado o quão fácil é para documentar, empacotar, registrar e distribuir seu componente. O Bower é, definitivamente, aquilo que você deveria usar para tornar o processo mais fácil para seus usuários e para você mesmo.</p>